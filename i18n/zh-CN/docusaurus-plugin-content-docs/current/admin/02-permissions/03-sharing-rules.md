# 共享规则

在 Steedos 中，**记录级权限**（即用户能看到表中的哪几行数据）主要由 **简档/权限集** 中的“数据范围”决定。

当“简档”中定义的基础范围（如“仅查看自己的”）无法满足复杂的业务需求时，我们才使用 **共享规则 (Sharing Rules)** 进行额外的授权。

## 1\. 基础权限：数据范围 (Scope)

**“能看多少数据”直接定义在对象权限中。**

在配置 **简档 (Profile)** 或 **权限集 (Permission Set)** 时，针对每个对象（如“合同”），除了勾选“允许读取”、“允许编辑”外，管理员必须指定 **数据范围**。

### 常见的权限范围选项

Steedos 通常提供以下几个层级的可见性控制：

| 范围级别 | 含义 | 适用场景 |
| :--- | :--- | :--- |
| **全部 (All)** | **公开**。用户可以查看/修改该对象表中的**所有**记录，无论属于谁。 | 管理员、数据审核员、公开的知识库。 |
| **本单位 (Company)** | **分部级**。用户可以看到其所属分部（及其子部门）下的所有数据。 | 分公司总经理、行政人员。 |
| **本部门 (Organization)** | **部门级**。用户可以看到其所属部门（及其子部门）下的所有数据。 | 部门经理。 |
| **仅所有者 (Owner)** | **私有**。用户只能看到**自己创建的**，或**所有者是自己**的记录。 | 普通销售员、普通员工。 |

:::tip 核心逻辑
如果您希望某类对象的默认权限是“私有”，请在该用户的简档中，将该对象的数据范围设置为 **“仅所有者 (Owner)”**。
:::

## 2\. 共享规则 (Sharing Rules)

当简档中的权限范围（如“仅所有者”）过于严格，但又不能直接开通“全部”权限时，我们需要使用 **共享规则** 来打通特定的数据壁垒。

**共享规则的原则：** 只能在现有权限基础上做“加法”，不能做“减法”。

### 适用场景

  * **跨部门协作**：北京分公司的销售虽然只能看自己的单子，但需要把“已签约”的合同共享给“总部财务部”查看。
  * **特定项目组**：某个特定的 VIP 客户记录，需要共享给“上市筹备组”的所有成员，无论这些成员属于哪个部门。

### 规则类型

#### A. 基于属性的共享 (Criteria-Based)

根据记录的具体字段值进行自动分享。

  * **规则**：当 `合同金额` \> 1,000,000 时。
  * **动作**：共享给 `风险控制部`。
  * **权限**：`只读`。

#### B. 基于组织的共享 (Organization-Based)

根据记录的归属部门进行分享。

  * **规则**：属于 `上海研发部` 的所有记录。
  * **动作**：共享给 `北京产品部`。
  * **权限**：`只读`。

## 3\. 权限排查实战

当用户反馈“我看不到数据”或“我看到了不该看的数据”时，请按以下逻辑排查：

1.  **第一步：检查简档/权限集 (The Base)**

      * 找到该用户的简档。
      * 检查对应对象的 **“允许读取”** 是否勾选？
      * 检查 **“数据范围”** 选的是什么？
          * 如果是 `Owner`，通过；
          * 如果是 `All`，那他自然能看到所有，无需排查后续。

2.  **第二步：检查记录所有者 (The Owner)**

      * 这条记录的 `Owner` 是谁？
      * 如果是用户自己，那肯定能看。
      * 如果不是用户自己，检查用户是否属于 `Owner` 所在部门的上级部门（且简档范围包含子部门）。

3.  **第三步：检查共享规则 (Sharing Rules)**

      * 是否有特定的共享规则将这条数据“投喂”给了该用户（或用户所在的部门/群组）。
